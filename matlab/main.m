n = 16;
k = 4;
A3 = [
    [0,0,1,0];
    [0,0,0,1];
    [0,1,0,0];
    [0,0,0,1];
    [0,0,1,0];
    [1,0,0,0];
    [0,0,0,1];
    [0,1,0,0];
    [1,0,0,0];
    [0,0,1,0];
    [0,1,0,0];
    [1,0,0,0];
];

B3 = [
    [0,0,0,1,0,1,0,0,1,0,0,0];
    [0,0,1,0,1,0,0,0,1,0,0,0];
    [1,0,1,0,0,1,0,0,0,0,0,0];
    [0,1,0,0,0,0,1,0,0,1,0,0];
    [0,0,0,0,1,0,0,0,0,0,1,1];
    [0,1,0,0,1,1,0,0,0,0,0,0];
    [0,0,0,1,0,0,0,1,0,0,1,0];
    [0,1,0,0,0,0,0,1,0,0,0,1];
    [0,0,1,0,0,0,0,0,0,1,0,1];
    [1,0,0,0,0,0,0,1,0,1,0,0];
    [0,0,0,0,0,0,1,0,1,0,1,0];
    [1,0,0,1,0,0,1,0,0,0,0,0];
];

H3 = [A3, B3];

B3_inv = inv_GF2(B3');
G1 = [eye(k), mod(A3'*B3_inv, 2)];
G2 = pchk2gen(H3, n, k);
isequal(G1, G2);

mat = load('H_5gnr_ldpc.mat', "H");
H_full = full(mat.H);
writematrix(H_full, "H_5gnr_ldpc.csv");
